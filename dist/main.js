(()=>{"use strict";class t{constructor(t){this.length=t,this.hits=0,this.sunk=!1}hit(){this.hits!==this.length&&(this.hits+=1)}isSunk(){return this.hits===this.length&&(this.sunk=!0),this.sunk}}class e{constructor(){this.board=[["A1","A2","A3","A4","A5","A6","A7","A8","A9","A10"],["B1","B2","B3","B4","B5","B6","B7","B8","B9","B10"],["C1","C2","C3","C4","C5","C6","C7","C8","C9","C10"],["D1","D2","D3","D4","D5","D6","D7","D8","D9","D10"],["E1","E2","E3","E4","E5","E6","E7","E8","E9","E10"],["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10"],["G1","G2","G3","G4","G5","G6","G7","G8","G9","G10"],["H1","H2","H3","H4","H5","H6","H7","H8","H9","H10"],["I1","I2","I3","I4","I5","I6","I7","I8","I9","I10"],["J1","J2","J3","J4","J5","J6","J7","J8","J9","J10"]],this.shipSquares=[],this.hitSquares=[],this.targetedSquares=[]}placeShip(e,r){if(this.shipSquares.length>=5)throw new Error("There can only be 5 ships on the board!");if(!(e instanceof t))throw new Error("First parameter must be a ship");if(e.length>5||e.length<2)throw new Error("Ship must be within the lengths 2-5");if(!Array.isArray(r))throw new Error("Parameter must be array!");if(e.length!==r.length)throw new Error("Coordinates must correspond to ship length!");r=r.map(t=>t.trim().toUpperCase());for(let t of r)if(!this.board.some(e=>e.includes(t)))throw new Error("Please enter a coordinate on the board!");const o=this.shipSquares.flatMap(t=>t.coords);for(let t of r)if(o.includes(t))throw new Error(`${t} is already occupied!`);if(!this.#t(r)&&!this.#e(r))throw new Error(`Ship of length ${e.length} is not placed correctly! Must be placed in consecutive rows or columns`);this.shipSquares.push({ship:e,coords:r})}receiveAttack(t){if(t=t.trim().toUpperCase(),!this.board.some(e=>e.includes(t)))throw new Error("Please enter a coordinate on the board!");for(const{ship:e,coords:r}of this.shipSquares)if(r.includes(t))return this.hitSquares.push(t),this.targetedSquares.push(t),e.hit(),e.isSunk()&&console.log(`Ship of length ${e.length} has been sunk`),!this.checkIfAllSunk()||"All sunk";return this.targetedSquares.push(t),!1}checkIfAllSunk(){return this.shipSquares.every(({ship:t})=>t.isSunk())}#r(t){if("string"!=typeof t||t.length<2)throw new Error("Invalid coordinate input");const e=(t=t.trim())[0].toUpperCase(),r=parseInt(t.slice(1),10);if(isNaN(r)||r<1||r>10)throw new Error("Column must be between 1 and 10");if(e<"A"||e>"J")throw new Error("Row must be between A and J");return{row:e,col:r}}#t(t){const e=t.map(this.#r);if(!e.every(t=>t.row===e[0].row))return!1;const r=e.map(t=>t.col).sort((t,e)=>t-e);for(let t=1;t<r.length;t++)if(r[t]!==r[t-1]+1)return!1;return!0}#e(t){const e=t.map(this.#r);if(!e.every(t=>t.col===e[0].col))return!1;const r=e.map(t=>t.row.charCodeAt(0)).sort((t,e)=>t-e);for(let t=1;t<r.length;t++)if(r[t]!==r[t-1]+1)return!1;return!0}}class r{constructor(t){this.name=t,this.gameboard=new e,this.cpu=!1,this.turn=!1,this.targetedCoords=new Set}attack(t,e){return t.gameboard.receiveAttack(e)}fillBoardRandomly(){const e=[{length:2},{length:3},{length:3},{length:4},{length:5}];for(let r of e){let e=!1;for(;!e;){const o=Math.floor(10*Math.random()),s=Math.floor(10*Math.random()),n=Math.random()<.5,a=[];for(let t=0;t<r.length;t++){const e=n?o+t:o,r=n?s:s+t;if(e>9||r>9)break;const i=`${String.fromCharCode(65+r)}${e+1}`;a.push(i)}a.length===r.length&&this.#o(a)&&(this.gameboard.placeShip(new t(r.length),a),e=!0)}}}randomAttack(t){let e;do{const t=Math.floor(10*Math.random()),r=Math.floor(10*Math.random());e=`${String.fromCharCode(65+t)}${r+1}`}while(this.targetedCoords.has(e));return this.targetedCoords.add(e),t.gameboard.receiveAttack(e)}#o(t){const e=this.gameboard.shipSquares.flatMap(t=>t.coords);for(let r of t)if(e.includes(r))return!1;return!0}}function o(t,e,r=!1){t.innerHTML="";for(let o=0;o<e.board.length;o++)for(let s=0;s<e.board[o].length;s++){const n=e.board[o][s],a=document.createElement("div");a.classList.add("cell"),a.dataset.coord=n,!r&&e.shipSquares.some(t=>t.coords.includes(n))&&a.classList.add("ship"),e.hitSquares.includes(n)?a.classList.add("hit"):e.targetedSquares.includes(n)&&a.classList.add("miss"),t.appendChild(a)}}document.querySelector("#start").addEventListener("click",()=>function(){const t=new r("CPU");t.cpu=!0,t.turn=!0,t.fillBoardRandomly();const e=new r("Real");function s(t,e){return t.gameboard.checkIfAllSunk()?`${e.name} wins!`:e.gameboard.checkIfAllSunk()?`${t.name} wins!`:null}return e.fillBoardRandomly(),function(t,e,r){document.querySelector(".game-area");const s=document.querySelector("#p1-board"),n=document.querySelector("#p2-board");o(s,t.gameboard),o(n,e.gameboard,!0),n.addEventListener("click",a=>{if(!a.target.classList.contains("cell"))return;const i=a.target.dataset.coord;t.attack(e,i),o(n,e.gameboard,!0);const h=r(t,e);if(h)return void console.log(h);e.randomAttack(t),o(s,t.gameboard);const l=r(t,e);l&&console.log(l)})}(e,t,s),{CPU:t,realPlayer:e,checkWinner:s}}(),{once:!0})})();